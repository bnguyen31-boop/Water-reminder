<script>
  let reminderInterval = null;
  let waterBreaks = parseInt(localStorage.getItem("waterBreaks")) || 0;
  const button = document.getElementById("reminderButton");
  const counter = document.getElementById("counter");

  const emojis = ["ðŸ’§", "ðŸŒ€", "ðŸŒŠ", "ðŸš°", "ðŸ«—"];
  const badges = {
    5: "ðŸ¥‰ Bronze Hydration Badge Unlocked!",
    10: "ðŸ¥ˆ Silver Hydration Badge Unlocked!",
    25: "ðŸ¥‡ Gold Hydration Badge Unlocked!",
    50: "ðŸ† Technician-Core Hydration Master!"
  };

  function updateCounter() {
    counter.textContent = `Water Breaks: ${waterBreaks}`;
    localStorage.setItem("waterBreaks", waterBreaks);

    if (badges[waterBreaks]) {
      alert(badges[waterBreaks]);
    }
  }

  async function startReminders() {
    if (Notification.permission !== "granted") {
      const permission = await Notification.requestPermission();
      if (permission !== "granted") {
        alert("Notifications are blocked. Ritual cannot proceed.");
        return;
      }
    }

    reminderInterval = setInterval(() => {
      waterBreaks++;
      updateCounter();

      const emoji = emojis[waterBreaks % emojis.length];
      new Notification(`${emoji} Time to hydrate!`, {
        body: `Sip #${waterBreaks} â€” Ritual maintenance required.`,
      });
    }, 60 * 60 * 1000); // 1 hour

    button.textContent = "Stop Reminders";
  }

  function stopReminders() {
    clearInterval(reminderInterval);
    reminderInterval = null;
    button.textContent = "Start Reminders";
  }

  button.addEventListener("click", () => {
    if (reminderInterval === null) {
      startReminders();
    } else {
      stopReminders();
    }
  });

  // Initialize counter on page load
  updateCounter();
</script>
